const n=_,e='k3rn-replaced',t='k3rn-trigger-active',o='k3rn-global-dropdown',r='k3rn-select-style',s='k3rn-scroll',i=`\n  #${o} {\n      position: absolute;\n      z-index: 99999;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.4);\n      max-height: 400px;\n      display: flex;\n      flex-direction: column;\n      background: var(--SmartThemeBlurTintColor, #1a1a1a);\n      color: var(--SmartThemeBodyColor, #eee);\n      border: 1px solid var(--SmartThemeBorderColor, #444);\n      border-radius: 4px;\n      font-size: 14px;\n      overflow: hidden;\n      backdrop-filter: blur(8px);\n      -webkit-backdrop-filter: blur(8px);\n  }\n\n  #${o} .search-wrapper {\n      padding: 8px;\n      background: rgba(0, 0, 0, 0.2);\n      border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n      flex-shrink: 0;\n  }\n\n  #${o} .search-input {\n      width: 100%;\n      padding: 6px 8px;\n      border-radius: 4px;\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      background: rgba(0, 0, 0, 0.3);\n      color: inherit;\n      outline: none;\n      font-size: 13px;\n  }\n  #${o} .search-input:focus {\n      border-color: var(--SmartThemeQuoteColor, #888);\n      background: rgba(0, 0, 0, 0.5);\n  }\n\n  #${o} .options-list {\n      overflow-y: auto;\n      flex-grow: 1;\n      max-height: 300px;\n  }\n\n  #${o} .options-list::-webkit-scrollbar {\n      width: 6px;\n  }\n  #${o} .options-list::-webkit-scrollbar-thumb {\n      background: rgba(255, 255, 255, 0.2);\n      border-radius: 3px;\n  }\n\n  #${o} .option-item {\n      padding: 8px 12px;\n      cursor: pointer;\n      transition: background 0.1s;\n  }\n  #${o} .option-item:hover {\n      background: rgba(255,255,255,0.1);\n  }\n  #${o} .option-item.selected {\n      background: rgba(255,255,255,0.15);\n      font-weight: bold;\n      border-left: 3px solid var(--SmartThemeQuoteColor, #888);\n  }\n  #${o} .no-results {\n      padding: 12px;\n      text-align: center;\n      color: var(--SmartThemeBodyColor, #eee);\n      font-style: italic;\n      display: none;\n  }\n`,a=()=>{const n=$(`.${t}`);n.length&&(n.parents().add(document).off(`.${s}`),n.removeClass(t)),$(`#${o}`).remove()},d=()=>{$('select').not(`[${e}]`).each(function(){const n=$(this);n.attr(e,'true'),n.on('mousedown',function(e){if(0!==e.button)return;e.preventDefault(),this.focus();n.hasClass(t)?a():(a(),l(n))}),n.on('keydown',function(e){if(' '===e.key||'Enter'===e.key){e.preventDefault(),e.stopPropagation();const o=n.hasClass(t);a(),o||l(n)}})})},l=e=>{e.addClass(t);e.parents().add(document).on(`scroll.${s}`,()=>{a()});const r=e.find('option'),i=[];r.each((_,n)=>{const t=$(n);if('none'===t.css('display'))return;const o=t.text(),r=t.is(':selected'),s=$(`<div class="option-item ${r?'selected':''}">${o}</div>`);s.data('search-text',o.toLowerCase()),s.on('click',n=>{n.stopPropagation();const o=t.val()??'undefined',r=e[0];r.value=o.toString(),r.dispatchEvent(new Event('change',{bubbles:!0})),r.dispatchEvent(new Event('input',{bubbles:!0})),e.trigger('change'),t.trigger('click'),a()}),s.on('mousedown touchstart touchend',n=>n.stopPropagation()),i.push(s)});const d=i.length>7,l=$(`<div id="${o}"></div>`),c=$('<div class="options-list"></div>'),p=$('<div class="no-results">无结果</div>');let u;if(d){const e=$('<div class="search-wrapper"><input type="text" class="search-input" placeholder="搜索…" /></div>');u=e.find('input'),u.on('input',(0,n.debounce)(n=>{const e=n.target.value.toLowerCase().trim();let t=!1;i.forEach(n=>{const o=n.data('search-text');!e||o.includes(e)?(n.css('display',''),t=!0):n.css('display','none')}),t?p.hide():p.show()},200)),u.on('mousedown click touchstart touchend',n=>n.stopPropagation()),l.append(e)}c.append(i).append(p),l.append(c),$('body').append(l);const h=e[0].getBoundingClientRect(),b=$(window).scrollTop()||0,g=$(window).scrollLeft()||0;let x=0;if(($(window).height()||0)-h.bottom<350&&h.top>350){const n=l.outerHeight()??300;x=h.top+b-n-4}else x=h.bottom+b+4;const m=Math.max(4,h.left+g);l.css({top:x+'px',left:m+'px',minWidth:Math.max(h.width,200)+'px'}),setTimeout(()=>{window.innerWidth<=768||!u||u.trigger('focus');const n=c.find('.selected');n.length&&c.scrollTop(n[0].offsetTop-c.height()/2)},10)},c=()=>{$(`#${r}`).remove(),$(`<style id="${r}">${i}</style>`).appendTo('head'),d();new MutationObserver(n=>{n.some(n=>n.addedNodes.length>0)&&d()}).observe(window.parent.document,{childList:!0,subtree:!0})};$(()=>{c(),window.parent.document.addEventListener('click',n=>{n.target&&(n.target.hasAttribute(e)||a())})});
//# sourceMappingURL=index.js.map